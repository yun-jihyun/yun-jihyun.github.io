---
layout: single
title:  "Project 01 - Revenue Management Intern [Marriott Internationl]"
categories: internship
---

# **Project 01** - Revenue Management Intern [Marriott International]
## **Loyalty Deep Dive Dashboard**

The **Loyalty Deep Dive Dashboard** was the first project I worked on during my internship at Marriott International. It was also my first time using **Power BI**, as my prior visualization experience had been limited to Python’s *matplotlib* and R’s *ggplot*.  
Building this dashboard was both **challenging and rewarding**, and it holds special meaning as the first business intelligence dashboard I ever created.

---
### **1) Problem Statement** 
The objective was to create a centralized, daily-refreshed dashboard for loyalty-related performance metrics.

Previously:  
- Loyalty performance metrics were scattered across multiple reports. 
- Data was not refreshed on a daily basis. 

This dashboard solves those issues by: 
- Bringing all loyalty metrics together into a single, consolidated view.  
- Providing daily data refresh for up-to-date insights.  
- Enabling drill-down analysis from property level up to city, country, and area level.  
- Supporting flexible and dynamic time period analysis.

---
### **2) Loyalty-related Performance Metrics**
The dashboard tracks 4 main categories of performance metrics:

- **MBV Occupancy**  
  - % of room nights booked by Marriott Bonvoy members.  
  - Includes targets (*K goals*) at property, area, and regional levels.
  - *MBV Occ vs K Goal* measures how much a property (or area/region) is overperforming or underperforming compared to its target.
  - *MBV Roomnight Opportunity to 75% / 80% / 85% MBV Occupancy*
     - This metric calculates how many additional member room nights would be needed to reach certain benchmark levels of MBV Occupancy (75%, 80%, or 85%).  
     - It provides a more objective way to compare properties of different sizes.  
       - For instance:  
         - Property A has 100 rooms and is currently at 78% MBV Occupancy. To increase to 80%, it needs **2 more member room nights**.  
         - Property B has 200 rooms at the same 78% MBV Occupancy. To reach 80%, it needs **4 more member room nights**.  
     - This helps identify where the biggest opportunities for improvement lie, not just in percentage terms but in actual member room nights needed. 

- **Enrollment**  
  - Count of new enrollments in the Marriott Bonvoy loyalty program.  
  - *Enrollment vs K Goal* measures how much a property (or area/region) is overperforming or underperforming compared to its target.

* Enrollment growth shows how much the loyalty program is expanding, but the raw number alone is not enough. What matters is whether these new members actually stay with us. That’s why it is important to also track **MBV Occupancy**, which reflects the quality of enrollments by showing how many members actively interact with our hotels.  

- **Roomnights**  
  - Total, member-only, and non-member room nights.  
- **Reservations**  
  - Total, member-only, and non-member reservations.  

For each metric, the dashboard provides:  
- **Year-over-Year (YoY) growth** – current vs. same period last year.  
- **Period-over-Period (PoP) growth** – current vs. previous comparable period.  
- Both **absolute** and **percentage growth**. 

---

### **3) Dynamic Time Period Selector**
The dashboard allows users to select how metrics are calculated and compared over different time periods:  
- Daily  
- Weekly  
- Monthly  
- Quarterly  
- Annually  
- Total (no breakdown)

Implementing **dynamic Period-on-Period (PoP) calculations** was a challenging feature, as the calculations need to update automatically based on the user’s selection.
### Implementation
- A **calendar table** was created with hierarchies for day, week, month, quarter, and year.  
- **Field parameters** were used to let users switch the time period dynamically.  
- When a user selects a time period, all metrics in the dashboard update automatically to reflect the chosen level.  

**Sample DAX for Calendar Table:**
```DAX
Calendar = 
ADDCOLUMNS (
    CALENDAR (MIN('FactTable'[Date]), MAX('FactTable'[Date])),
    "Year", YEAR([Date]),
    "Month", FORMAT([Date], "MMM YYYY"),
    "Quarter", "Q" & FORMAT([Date], "Q YYYY"),
    "Week", WEEKNUM([Date]),
    "NoBreakdown", "Total"
)
```

--- 
### **4) Dynamic Period-on-Period Calculation**
Once the dynamic time period selector was implemented, the next challenge was to make the metric calculations respond automatically to the user’s selection.  

This involved 3 steps:

1. **Capture the Selected Time Period**  
   - The `SELECTEDVALUE` function cannot be used directly on field parameters.  
   - Solution: create a **measure** to capture the selected time period.

```DAX
Selected Time Period = 
SWITCH(
    TRUE(),
    ISFILTERED('Calendar'[Day]), "Day",
    ISFILTERED('Calendar'[Week]), "Week",
    ISFILTERED('Calendar'[Month]), "Month",
    ISFILTERED('Calendar'[Quarter]), "Quarter",
    ISFILTERED('Calendar'[Year]), "Year",
    "Total"
)
```
2. **Calculate Metrics for Current and Previous Periods**
   - Create a measure for the current period metric.
   - Create a measure for the previous period metric, using the SWITCH function to adjust based on the selected time period.

3. **Calculate Period-on-Period Growth**
   - Absolute growth = Current – Previous
   - % Growth = (Current / Previous) – 1

This approach ensures that all metrics automatically update according to the selected time period, making the dashboard flexible for different levels of analysis (daily, weekly, monthly, etc.)

---

## **5) Dynamic Table**
The main table in the dashboard is fully customizable, allowing users to adjust how data is displayed. 
It is organized into three sections— 1. **dimensions**, 2) **time period**, and 3) **metrics**—allowing stakeholders to analyze performance by any dimension, over any timeframe, and for any metric of interest. 

- **Left: Dimensions**  
  - Users can analyze at any level: property, country, area, etc.  
  - Categories:  
    - Geography (area, country, property, etc.).  
    - Property type (brand tier, management type, etc.).  
    - Guest type (member tier, market segment, channel, etc.).  

- **Middle: Time Period Column**  
  - Dynamically switches (daily, weekly, monthly, etc.) based on user selection.  

- **Right: Metrics**  
  - Users can select which metrics to display (MBV Occupancy, Enrollments, Roomnights, Reservations). 
---
