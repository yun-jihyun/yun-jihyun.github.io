---
layout: single
title:  "Internship Project 01 - Loyalty Deep Dive Dashboard"
categories: internship
classes: wide
tags: ["Data Visualization", "Power BI"]
---
**Revenue Management Internship at Marriott International**

# **Loyalty Deep Dive Dashboard** 
The Loyalty Deep Dive Dashboard was the first project I worked on during my internship at Marriott International. It was also my first time using Power BI, as my prior visualization experience had been limited to Python’s *matplotlib* and R’s *ggplot*.  
Building this dashboard was both challenging and rewarding, and it holds special meaning as the first business intelligence dashboard I ever created.

![Loyalty Deep Dive Dashboard](/assets/images/loyalty_deep_dive.png) 


## **(1) Problem Statement** 
The objective was to create a centralized, daily-refreshed dashboard for loyalty performance metrics.

Previously:  
- Loyalty performance metrics were scattered across multiple reports. 
- Data was not refreshed on a daily basis. 

This dashboard solves those issues by: 
- Bringing all loyalty metrics together into a single, consolidated view.  
- Providing daily data refresh for up-to-date insights.  
- Enabling drill-down analysis from property level up to city, country, and area level.  
- Supporting flexible and dynamic time period analysis.


## **(2) Loyalty Performance Metrics**
The dashboard tracks 4 main categories of performance metrics:

- **1) MBV Occupancy**  
  - The % of room nights booked by Marriott Bonvoy members.  
  - Includes targets (*K goals*) at property, area, and regional levels.
  - **MBV Occ vs K Goal** measures how much a property (or area/region) is overperforming or underperforming compared to its target.
  - **MBV Roomnight Opportunity to 75% / 80% / 85% MBV Occupancy**
     - This metric calculates how many additional member room nights would be needed to reach certain benchmark levels of MBV Occupancy (75%, 80%, or 85%).  
     - It provides a more objective way to compare properties of different sizes.  
       - For instance, consider property A with 100 rooms and property B with 200 rooms. They are both at 78% MBV Occupancy currently. However, property A needs 2 more member roomnights, whereas property B will need 4 more member roomnights.
     - As such, this metric helps to identify where the biggest opportunities for improvement lie, not just in percentage terms but in actual member room nights needed. 
- **2) Enrollment**  
  - Count of new enrollments in the Marriott Bonvoy loyalty program.  
  - **Enrollment vs K Goal** measures how much a property (or area/region) is overperforming or underperforming compared to its target.
- **3) Roomnights**  
  - Total, member-only, and non-member room nights.  
- **4) Reservations**  
  - Total, member-only, and non-member reservations.

> **Note**: Enrollment growth shows how much the loyalty program is expanding, but the raw number alone is not enough. What matters is whether these new members actually stay with us. That’s why it is important to also track MBV Occupancy, which reflects the **quality of enrollments** by showing how many members actively interact with our properties.  


For each metric, the dashboard provides:  
- **Year-over-Year (YoY) growth** – current vs. same time last year.  
- **Period-over-Period (PoP) growth** – current vs. previous comparable period.  
- Both **absolute** and **percentage growth**. 


## **(3) Dynamic Time Period Selector**
The dashboard allows users to select how metrics are calculated and compared over different time periods: daily, weekly, monthly, quarterly, annually, and total selected date range. 

##### Implementation 
  - 1) Create a **dummy calendar table** with 6 columns: day, week, month, quarter, year, and no time breakdown. 
  
  ```
  Calendar = ADDCOLUMNS(
          CALENDAR(DATE(2024,1,1), EndDate),
          "Week",
            VAR StartDate = DATE(2023, 12, 31)
            VAR DiffCount = DATEDIFF(StartDate, [Date], DAY)
            RETURN StartDate + (INT(DiffCount / 7) * 7),
          "Month",
            DATE(YEAR([Date]), MONTH([Date]), 1),
          "Quarter",
            DATE(YEAR([Date]), (INT((MONTH([Date])-1) / 3) * 3) + 1, 1),
          "Year",
            DATE(YEAR([Date]), 1, 1), 
          "No Date Breakdown",
            "Total"
)
```
> **Note**: Keep in mind to begin week counting from Sunday. 

  - 2) Create a **field parameter** to allow users to switch the time period dynamically. 

  ```
  Time Period Breakdown = {
        ("Daily", NAMEOF('Calendar'[Date]), 0),
        ("Weekly", NAMEOF('Calendar'[Week]), 1),
        ("Monthly", NAMEOF('Calendar'[Month]), 2),
        ("Quarterly", NAMEOF('Calendar'[Quarter]), 3),
        ("Annually", NAMEOF('Calendar'[Year]), 4),
        ("No Time Breakdown", NAMEOF('Calendar'[No Date Breakdown]), 5)
  )
  ``` 


## **(4) Dynamic Period-on-Period Calculation**
Once the dynamic time period selector was implemented, the next challenge was to make the metric calculations respond automatically to the user’s selection.  

This involved 3 steps:

  - **1) Capture the Selected Time Period**  
   - The `SELECTEDVALUE` function cannot be used directly on field parameters. 
   - Solution: create a **measure** to capture the selected time period.

 ```
 Selected Time Period =
   VAR SelectedValue = SELECTCOLUMNS(
                  SUMMARIZE('Time Period Breakdown', 'Time Period Breakdown'[Time Period], 'Time Period Breakdown'[Time Period Fields], 'Time Period Breakdown'[Time Period Order]),
                  'Time Period Breakdown'[Time Period]
   )

   RETURN IF(COUNTROWS(SelectedValue)=1, SelectedValue)
 ```
   
  - **2) Calculate Metrics for Current and Previous Periods**
    - a. Create a measure for the current period metric.

     ``` 
     MBV Occupancy =
     CALCULATE(
                DIVIDE(
                  CALCULATE(
                    SUM('Data Table'[ROOMNIGHTS]), 
                    'Data Table'[MEMBER_IND] = "Member"
                  ), 
                  SUM('Data Table'[ROOMNIGHTS])
                )
    ) 
    ```

    - b. Create a measure for the previous period metric, using the `SWITCH` function to adjust based on the selected time period.

    ```
    MBV Occupancy Previous Period = SWITCH(
      TRUE(),
      [Selected Time Period] = "Daily", 
       CALCULATE(
             [MBV Occupancy], 
             DATEADD('Calendar'[Date], -1, DAY), 
             REMOVEFILTERS('Calendar'[Date])
      ), 
      [Selected Time Period] = "Weekly", 
       CALCULATE(
             [MBV Occupancy], 
             DATEADD('Calendar'[Week], -7, DAY), 
             REMOVEFILTERS('Calendar'[Date])
      ),
      [Selected Time Period] = "Monthly", 
       CALCULATE(
             [MBV Occupancy], 
             DATEADD('Calendar'[Month], -1, MONTH), 
             REMOVEFILTERS('Calendar'[Date])
      ), 
      [Selected Time Period] = "Quarterly", 
       CALCULATE(
             [MBV Occupancy], 
             DATEADD('Calendar'[Quarter], -3, MONTH), 
             REMOVEFILTERS('Calendar'[Date])
      ), 
      [Selected Time Period] = "Annually", 
       CALCULATE(
             [MBV Occupancy], 
             DATEADD('Calendar'[Year], -1, YEAR), 
             REMOVEFILTERS('Calendar'[Date])
      ),  
      [Selected Time Period] = "No Time Breakdown", 
       VAR dateRange = (MAX('Data Table'[Date]) - MIN('Date Table'[Date])) + 1 
       RETURN 
         CALCULATE(
               [MBV Occupancy], 
               DATEADD('Calendar'[Date], -dateRange, DAY), 
               REMOVEFILTERS('Calendar'[Date])
         ),
      BLANK()
    )
    ```

  - **3). Calculate Period-on-Period Growth** 
    - Absolute growth = Current – Previous
    - % Growth = (Current / Previous) – 1

This enables all metrics to automatically update according to the selected time period, making the dashboard flexible for different levels of analysis (daily, weekly, monthly, etc.) 


## **(5) Dynamic Table**
The main table in the dashboard is fully customizable, allowing users to adjust how data is displayed. 
It is organized into three sections— dimensions, time period, and metrics—allowing stakeholders to analyze performance by any dimension, over any timeframe, and for any metric of interest. 

- Section 1: **Dimensions**  
  - Users can analyze at any level: property, country, area, etc.  
  - Categories:  
    - Geography (area, country, property, etc.).  
    - Property type (brand tier, management type, etc.).  
    - Guest type (member tier, market segment, channel, etc.).  

- Section 2: **Time Period Column**  
  - Dynamically switches (daily, weekly, monthly, etc.) based on user selection.  

- Section 3: **Performance Metrics**  
  - Users can select which metrics to display (MBV Occupancy, Enrollments, Roomnights, Reservations).
  
![Three Sections of the Dynamic Table](/assets/images/dynamic_table.png) 
---
