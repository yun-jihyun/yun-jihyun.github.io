---
layout: single
title:  "Internship Project 02 - Global Sales Organization Support Tool"
categories: internship
classes: wide
tags: ["Data-Driven Business Strategy", "Data Visualization", "Power BI"] 
---
**Revenue Management Internship at Marriott International**

# **Global Sales Organization Support Tool** 

The **Global Sales Organization (GSO)** at Marriott manages contracts with corporate accounts. These contracts are a key driver of the **special corporate market segment** in Marriott’s business. In 2025, the Marriott APEC region began a major strategic shift in this corporate segment: transitioning from **static rates** to **dynamic rates**.  

- **Static rate** → A fixed room rate, regardless of market demand.  
  - Corporates are guaranteed a low rate even during peak demand, whereas Marriott loses potential revenue by offering discounted rates during high-demand periods.
- **Dynamic rate** → A fixed discount percentage applied to the retail rate.
  - Rates will rise in response to the incresing demand in high-demand periods, allowing Marriott to optimize its revenue, while still allowing corporates to receive a discounted rate. 

The purpose of this project was to build a data-driven strategy support tool that can aid the GSO team convince corporate accounts of the value of adopting dynamic rates.  


## **(1) Problem Statement** 

The tool needed to deliver three essential data points for the GSO team:
- **Corporate Savings** → How much would corporates save under a dynamic discounted rate compared to retail rates?
- **Marriott Revenue Growth** → How much would revenue grow compared to the historic static rate when implementing the dynamic rate? 
- **Rate Availability** → On how many check-in days would that dynamic discounted rate actually be available?  

##### Key Challenges
- **Hurdle Revenue Constraint**:
  - Every property sets a **minimum revenue threshold per night** (hurdle). A discounted rate is only valid if it exceeds this hurdle.  
- **Length of Stay Effect**:
  - Hurdle thresholds vary depending on the **length of stay (LOS)**, so the validity of a discount must be checked at the stay level, not per night.  
- **Dynamic User Inputs**:
  - The tool should allow the GSO team to enter different **discount percentages** and **lengths of stay** dynamically and see calculated results correspondingly.
  - A dynamic input on the **account’s historic rate** should enable users to calculate the percentage growth between the historic rate and the forecasted rate under the dynamic rate.


## **(2) Forecast Calculation Logic**  

The tool allows the user to input three parameters:  
- Historic Rate
- Length of Stay
- Discount Percentage

Based on these, the tool calculates the following values:  
1. **Account Average Daily Rate (ADR) Growth %**
   - The percentage growth between the account’s historic rate and the forecasted dynamic rate.
     
2. **Forecasted Retail ADR**
   - The projected standard rate a retail customer would pay in the future.
     
3. **Forecasted Discounted ADR**
   - The projected rate after applying the selected corporate discount % to the retail ADR.
     
5. **Forecasted Average Daily Hurdle Revenue**
   - The minimum revenue threshold per night, averaged across the length of stay.
     
6. **Forecasted True Account ADR**
   - The final rate corporates would pay:  
     - If the **average discounted ADR ≥ average daily hurdle revenue**, the discounted ADR applies.  
     - If the **average discounted ADR < aaverage daily hurdle revenue**, the retail ADR applies instead.

--- 
**Example Calculation:** 

Consider a **2-night stay** with a **20% discount**. 

| Check-In Date | Stay Date   | Retail Rate | Discount % | Discounted Rate | Hurdle Revenue | Avg. Discounted Rate | Avg. Hurdle Revenue |
|--------------|-------------|-----------:|-----------:|----------------:|---------------:|--------------------:|--------------------:|
| 01 Sep 2025  | 01 Sep 2025 | $300.00    | 20%        | $240.00         | $250.00        |                    |                    |
| 01 Sep 2025  | 02 Sep 2025 | $200.00    | 20%        | $160.00         | $140.00        |                    |                    |
| **Averages** |             |            |            |                 |                | **$200.00**        | **$195.00**        |

- On **01 Sep 2025**, the discounted rate ($240) is **below** the hurdle ($250).  
- On **02 Sep 2025**, the discounted rate ($160) is **above** the hurdle ($140).  
- However, the decision is not made per-night. Instead:  
  - Average Discounted Rate = (240 + 160) ÷ 2 = **$200.00**  
  - Average Hurdle Revenue = (250 + 140) ÷ 2 = **$195.00**
  - → Since $200 > $195, the discounted rate is valid. Hence, the corporate will pay the **discounted rate** for both nights.

---

To make the tool more practical and insightful for corporate strategy, additional data points were incorporated as well:
- The absolute number and percentage of check-in days where **the forecasted discounted rate is lower than the historic rate**.
- The absolute number and percentage of check-in days where **the forecasted discounted rate exceeds the hurdle, and is therefore available**.


## **(4) Power BI Implementation**  

One of the biggest challenges in implementing this tool in Power BI DAX was handling grouped calculations while incorporating multiple user-selected parameters. 

The difficulty comes from the fact that I needed to:
- Calculate the average rate (or hurdle revenue) over multiple days for each stay, based on the selected length of stay.
- Then, compute the average of these stay-level averages across all check-in dates.


**Solution Approach**: creating an intermediate imaginary table and then layering calculations step by step 

**Step 1** 
- Create an intermediate imaginary table with the level of aggregation required for the calculation. In this case, a unique **property x check-in date** combination. 
  ```
  SUMMARIZE(
      TABLE,
      TABLE[Property],
      TABLE[Stay Date]
  )
  ```

**Step 2** 
- Add a calculated column for average rate (or hurdle revenue) calculation.
- For each row in the **summarized table in Step 1**, calculate the average rate (or hurdle revenue) across the length of stay starting from that check-in date.
  ```
  ADDCOLUMNS(
      SUMMARIZE(
          TABLE,
          TABLE[Property],
          TABLE[Stay Date]
      ),
      "Rolling Retail Rate",
      CALCULATE(
          AVERAGE([Retail Rate]),
          DATESBETWEEN(
              TABLE[Stay Date],
              TABLE[Stay Date], // Check-in date
              TABLE[Stay Date] + ([Selected Length of Stay]-1) // Check-out date
          )
      )
  )
  ```

**Step 3**
- Finally, calculate the average of the **calculated column in Step 2**.
  ```
  AVERAGEX(
      ADDCOLUMNS(
          SUMMARIZE(
              TABLE,
              TABLE[Property],
              TABLE[Stay Date]
          ),
          "Rolling Retail Rate",
          CALCULATE(
              AVERAGE([Retail Rate]),
              DATESBETWEEN(
                  TABLE[Stay Date],
                  TABLE[Stay Date], 
                  TABLE[Stay Date] + ([Selected Length of Stay]-1)
              )
          )
      ),
      [Rolling Retail Rate]
  )
  ```

As such, by leveraging `SUMMARIZE` + `ADDCOLUMNS` + `AVERAGEX`, I was able to perform a **double aggregation** in DAX, effectively calculating an average of averages.


## **(5) Power BI Dashboard**  


> Note: The rate can be displayed in either USD or the local currency, selectable via the filter at the top-right corner of the dashboard. This requirement influenced the design of the **dynamic user input for the historic rate**, which is divided into three separate fields: **millions, thousands, and hundreds**. The reason for this division is that Power BI numeric range parameters are limited to 1,002 distinct values. Exceeding this limit causes errors. While USD rates typically remain within three digits, certain local currencies, such as JPY or KRW, may require values up to nine digits. By splitting the input into millions, thousands, and hundreds, the dashboard allows users to enter flexible historic rates without exceeding the numeric parameter limit.
